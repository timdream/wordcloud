/*! wordcloud-app  2019-11-28 */

var FACEBOOK_APP_ID="221493074531416",GOOGLE_CLIENT_ID="978080547219.apps.googleusercontent.com",IMGUR_CLIENT_ID="89b3cee0ba1b537",DONATE_HTML='<form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank">  <input type="hidden" name="cmd" value="_s-xclick">  <input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----MIIHLwYJKoZIhvcNAQcEoIIHIDCCBxwCAQExggEwMIIBLAIBADCBlDCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20CAQAwDQYJKoZIhvcNAQEBBQAEgYApgNc/KQPkXsONn7pwRFoID+QfTjZPt5iARTMrig/8BGwXEZ8O86unaR5xH5DKdFhrwBGRm5Ibr7p60phsVab0ZAXLrSBSEAK1AfxWtQzAYLtAbmsM1c9fDHVlidWThIL/HcUX2loOa/X5jYLuOy/4aIEnjj/9pUnCImIAchpL7TELMAkGBSsOAwIaBQAwgawGCSqGSIb3DQEHATAUBggqhkiG9w0DBwQIozjDTqCOFQWAgYiaWIwn8Ut10Es4W/1P4rwVUPXqFigIJxDuJINGNmKNV5/Zr7Pxt0f+woUNa2RbrNqowVqkFu2ZjHpg13rBkKzFS7C8lwGxDMat6XwDWnxhd+pdaQHo6ZD2rbbwb7knEUjxxc0FUYxO8mv5cXTTlyfjORb3zaP0Eq/NiSabeP7Txm9WdxCrO9VboIIDhzCCA4MwggLsoAMCAQICAQAwDQYJKoZIhvcNAQEFBQAwgY4xCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEUMBIGA1UEChMLUGF5UGFsIEluYy4xEzARBgNVBAsUCmxpdmVfY2VydHMxETAPBgNVBAMUCGxpdmVfYXBpMRwwGgYJKoZIhvcNAQkBFg1yZUBwYXlwYWwuY29tMB4XDTA0MDIxMzEwMTMxNVoXDTM1MDIxMzEwMTMxNVowgY4xCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEUMBIGA1UEChMLUGF5UGFsIEluYy4xEzARBgNVBAsUCmxpdmVfY2VydHMxETAPBgNVBAMUCGxpdmVfYXBpMRwwGgYJKoZIhvcNAQkBFg1yZUBwYXlwYWwuY29tMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDBR07d/ETMS1ycjtkpkvjXZe9k+6CieLuLsPumsJ7QC1odNz3sJiCbs2wC0nLE0uLGaEtXynIgRqIddYCHx88pb5HTXv4SZeuv0Rqq4+axW9PLAAATU8w04qqjaSXgbGLP3NmohqM6bV9kZZwZLR/klDaQGo1u9uDb9lr4Yn+rBQIDAQABo4HuMIHrMB0GA1UdDgQWBBSWn3y7xm8XvVk/UtcKG+wQ1mSUazCBuwYDVR0jBIGzMIGwgBSWn3y7xm8XvVk/UtcKG+wQ1mSUa6GBlKSBkTCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb22CAQAwDAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQUFAAOBgQCBXzpWmoBa5e9fo6ujionW1hUhPkOBakTr3YCDjbYfvJEiv/2P+IobhOGJr85+XHhN0v4gUkEDI8r2/rNk1m0GA8HKddvTjyGw/XqXa+LSTlDYkqI8OwR8GEYj4efEtcRpRYBxV8KxAW93YDWzFGvruKnnLbDAF6VR5w/cCMn5hzGCAZowggGWAgEBMIGUMIGOMQswCQYDVQQGEwJVUzELMAkGA1UECBMCQ0ExFjAUBgNVBAcTDU1vdW50YWluIFZpZXcxFDASBgNVBAoTC1BheVBhbCBJbmMuMRMwEQYDVQQLFApsaXZlX2NlcnRzMREwDwYDVQQDFAhsaXZlX2FwaTEcMBoGCSqGSIb3DQEJARYNcmVAcGF5cGFsLmNvbQIBADAJBgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0BCQUxDxcNMTMwNjI1MTM0NzQxWjAjBgkqhkiG9w0BCQQxFgQU3kDruxd7qMkSyV1DI06NyIGmCXgwDQYJKoZIhvcNAQEBBQAEgYAV3gjHdsVXK3JTEj/IfC7e8hEoLnW6X94Xqmt6at4+qWAsrAfpkz9Eh+eAq+My8wRnmzGl91L2ytkJg6/zH+NWQZhbpTy7uUzgBynRICEDImrL+4Jab2quZmRv8RVRrKBu07DjgK/rpVfl4vIbtPQaanxI52YAMUMBIZD340m62g==-----END PKCS7-----">  <input type="image" src="https://www.paypalobjects.com/%lang/i/btn/btn_donate_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!"></form>';if(document.webL10n=function(window,document,undefined){var gL10nData={},gTextData="",gTextProp="textContent",gLanguage="",gMacros={},gReadyState="loading",gAsyncResourceLoading=!0,gDEBUG=1;function consoleLog(e){2<=gDEBUG&&console.log("[l10n] "+e)}function consoleWarn(e){gDEBUG&&console.warn("[l10n] "+e)}function getL10nResourceLinks(){return document.querySelectorAll('link[type="application/l10n"]')}function getL10nDictionary(){var e=document.querySelector('script[type="application/l10n"]');return e?JSON.parse(e.innerHTML):null}function getTranslatableChildren(e){return e?e.querySelectorAll("*[data-l10n-id]"):[]}function getL10nAttributes(e){if(!e)return{};var t=e.getAttribute("data-l10n-id"),n=e.getAttribute("data-l10n-args"),o={};if(n)try{o=JSON.parse(n)}catch(e){consoleWarn("could not parse arguments for #"+t)}return{id:t,args:o}}function fireL10nReadyEvent(e){var t=document.createEvent("Event");t.initEvent("localized",!0,!1),t.language=e,document.dispatchEvent(t)}function xhrLoadText(e,t,n,o){t=t||function(){},n=n||function(){consoleWarn(e+" not found.")};var i=new XMLHttpRequest;i.open("GET",e,o),i.overrideMimeType&&i.overrideMimeType("text/plain; charset=utf-8"),i.onreadystatechange=function(){4==i.readyState&&(200==i.status||0===i.status?t(i.responseText):n())},i.onerror=n,i.ontimeout=n;try{i.send(null)}catch(e){n()}}function parseResource(e,E,r,t){var v=e.replace(/[^\/]*$/,"")||"./";function s(e){var c=[],u=/^\s*|\s*$/,p=/^\s*#|^\s*$/,m=/^\s*\[(.*)\]\s*$/,w=/^\s*@import\s+url\((.*)\)\s*$/i,f=/^([^=\s]*)\s*=\s*(.+)$/;function g(e,t){for(var n,o=e.replace(u,"").split(/[\r\n]+/),i="*",a=E.replace(/-[a-z]+$/i,""),r=!1,s="",l=0;l<o.length;l++){var d=o[l];if(!p.test(d)){if(t){if(m.test(d)){r="*"!==(i=(s=m.exec(d))[1])&&i!==E&&i!==a;continue}if(r)continue;w.test(d)&&(s=w.exec(d),xhrLoadText(v+s[1],function(e){g(e,!1)},null,!1))}var h=d.match(f);h&&3==h.length&&(c[h[1]]=(n=h[2]).lastIndexOf("\\")<0?n:n.replace(/\\\\/g,"\\").replace(/\\n/g,"\n").replace(/\\r/g,"\r").replace(/\\t/g,"\t").replace(/\\b/g,"\b").replace(/\\f/g,"\f").replace(/\\{/g,"{").replace(/\\}/g,"}").replace(/\\"/g,'"').replace(/\\'/g,"'"))}}}return g(e,!0),c}xhrLoadText(e,function(e){gTextData+=e;var t=s(e);for(var n in t){var o,i,a=n.lastIndexOf(".");i=0<a?(o=n.substring(0,a),n.substr(a+1)):(o=n,gTextProp),gL10nData[o]||(gL10nData[o]={}),gL10nData[o][i]=t[n]}r&&r()},t,gAsyncResourceLoading)}function loadLocale(e,t){t=t||function(){},clear(),gLanguage=e=e.replace(/-[a-z]{2}$/i,function(e){return e.toUpperCase()});var n=getL10nResourceLinks(),o=n.length;if(0==o){var i=getL10nDictionary();return i&&i.locales&&i.default_locale?(consoleLog("using the embedded JSON directory, early way out"),gL10nData=i.locales[e]||i.locales[i.default_locale],t()):consoleLog("no resource to load, early way out"),fireL10nReadyEvent(e),void(gReadyState="complete")}var a,r=0;function s(e){var o=e.href;e.type;this.load=function(e,t){var n=e;return parseResource(o,e,t,function(){consoleWarn(o+" not found."),n=""}),n}}a=function(){o<=++r&&(t(),fireL10nReadyEvent(e),gReadyState="complete")};for(var l=0;l<o;l++){new s(n[l]).load(e,a)!=e&&(consoleWarn('"'+e+'" resource not found'),gLanguage="")}}function clear(){gL10nData={},gLanguage=gTextData=""}function getPluralRules(e){function t(e,t){return-1!==t.indexOf(e)}function n(e,t,n){return t<=e&&e<=n}var o={0:function(e){return"other"},1:function(e){return n(e%100,3,10)?"few":0===e?"zero":n(e%100,11,99)?"many":2==e?"two":1==e?"one":"other"},2:function(e){return 0!==e&&e%10==0?"many":2==e?"two":1==e?"one":"other"},3:function(e){return 1==e?"one":"other"},4:function(e){return n(e,0,1)?"one":"other"},5:function(e){return n(e,0,2)&&2!=e?"one":"other"},6:function(e){return 0===e?"zero":e%10==1&&e%100!=11?"one":"other"},7:function(e){return 2==e?"two":1==e?"one":"other"},8:function(e){return n(e,3,6)?"few":n(e,7,10)?"many":2==e?"two":1==e?"one":"other"},9:function(e){return 0===e||1!=e&&n(e%100,1,19)?"few":1==e?"one":"other"},10:function(e){return n(e%10,2,9)&&!n(e%100,11,19)?"few":e%10!=1||n(e%100,11,19)?"other":"one"},11:function(e){return n(e%10,2,4)&&!n(e%100,12,14)?"few":e%10==0||n(e%10,5,9)||n(e%100,11,14)?"many":e%10==1&&e%100!=11?"one":"other"},12:function(e){return n(e,2,4)?"few":1==e?"one":"other"},13:function(e){return n(e%10,2,4)&&!n(e%100,12,14)?"few":1!=e&&n(e%10,0,1)||n(e%10,5,9)||n(e%100,12,14)?"many":1==e?"one":"other"},14:function(e){return n(e%100,3,4)?"few":e%100==2?"two":e%100==1?"one":"other"},15:function(e){return 0===e||n(e%100,2,10)?"few":n(e%100,11,19)?"many":1==e?"one":"other"},16:function(e){return e%10==1&&11!=e?"one":"other"},17:function(e){return 3==e?"few":0===e?"zero":6==e?"many":2==e?"two":1==e?"one":"other"},18:function(e){return 0===e?"zero":n(e,0,2)&&0!==e&&2!=e?"one":"other"},19:function(e){return n(e,2,10)?"few":n(e,0,1)?"one":"other"},20:function(e){return!n(e%10,3,4)&&e%10!=9||n(e%100,10,19)||n(e%100,70,79)||n(e%100,90,99)?e%1e6==0&&0!==e?"many":e%10!=2||t(e%100,[12,72,92])?e%10!=1||t(e%100,[11,71,91])?"other":"one":"two":"few"},21:function(e){return 0===e?"zero":1==e?"one":"other"},22:function(e){return n(e,0,1)||n(e,11,99)?"one":"other"},23:function(e){return n(e%10,1,2)||e%20==0?"one":"other"},24:function(e){return n(e,3,10)||n(e,13,19)?"few":t(e,[2,12])?"two":t(e,[1,11])?"one":"other"}},i={af:3,ak:4,am:4,ar:1,asa:3,az:0,be:11,bem:3,bez:3,bg:3,bh:4,bm:0,bn:3,bo:0,br:20,brx:3,bs:11,ca:3,cgg:3,chr:3,cs:12,cy:17,da:3,de:3,dv:3,dz:0,ee:3,el:3,en:3,eo:3,es:3,et:3,eu:3,fa:0,ff:5,fi:3,fil:4,fo:3,fr:5,fur:3,fy:3,ga:8,gd:24,gl:3,gsw:3,gu:3,guw:4,gv:23,ha:3,haw:3,he:2,hi:4,hr:11,hu:0,id:0,ig:0,ii:0,is:3,it:3,iu:7,ja:0,jmc:3,jv:0,ka:0,kab:5,kaj:3,kcg:3,kde:0,kea:0,kk:3,kl:3,km:0,kn:0,ko:0,ksb:3,ksh:21,ku:3,kw:7,lag:18,lb:3,lg:3,ln:4,lo:0,lt:10,lv:6,mas:3,mg:4,mk:16,ml:3,mn:3,mo:9,mr:3,ms:0,mt:15,my:0,nah:3,naq:7,nb:3,nd:3,ne:3,nl:3,nn:3,no:3,nr:3,nso:4,ny:3,nyn:3,om:3,or:3,pa:3,pap:3,pl:13,ps:3,pt:3,rm:3,ro:9,rof:3,ru:11,rwk:3,sah:0,saq:3,se:7,seh:3,ses:0,sg:0,sh:11,shi:19,sk:12,sl:14,sma:7,smi:7,smj:7,smn:7,sms:7,sn:3,so:3,sq:3,sr:11,ss:3,ssy:3,st:3,sv:3,sw:3,syr:3,ta:3,te:3,teo:3,th:0,ti:4,tig:3,tk:3,tl:4,tn:3,to:0,tr:0,ts:3,tzm:22,uk:11,ur:3,ve:3,vi:0,vun:3,wa:4,wae:3,wo:0,xh:3,xog:3,yo:0,zh:0,zu:3}[e.replace(/-.*$/,"")];return i in o?o[i]:(consoleWarn("plural form unknown for ["+e+"]"),function(){return"other"})}function getL10nData(e,t){var n=gL10nData[e];n||consoleWarn("#"+e+" is undefined.");var o={};for(var i in n){var a=n[i];a=substArguments(a=substIndexes(a,t,e,i),t,e),o[i]=a}return o}function substIndexes(e,t,n,o){var i=/\{\[\s*([a-zA-Z]+)\(([a-zA-Z]+)\)\s*\]\}/.exec(e);if(!i||!i.length)return e;var a,r=i[1],s=i[2];t&&s in t?a=t[s]:s in gL10nData&&(a=gL10nData[s]),r in gMacros&&(e=(0,gMacros[r])(e,a,n,o));return e}function substArguments(e,t,n){for(var o=/\{\{\s*(.+?)\s*\}\}/,i=o.exec(e);i;){if(!i||i.length<2)return e;var a=i[1],r="";if(t&&a in t)r=t[a];else{if(!(a in gL10nData))return consoleLog("argument {{"+a+"}} for #"+n+" is undefined."),e;r=gL10nData[a][gTextProp]}e=e.substring(0,i.index)+r+e.substr(i.index+i[0].length),i=o.exec(e)}return e}function translateElement(e){var t=getL10nAttributes(e);if(t.id){var n=getL10nData(t.id,t.args);if(n){if(n[gTextProp]){if(0===getChildElementCount(e))e[gTextProp]=n[gTextProp];else{for(var o=e.childNodes,i=!1,a=0,r=o.length;a<r;a++)3===o[a].nodeType&&/\S/.test(o[a].nodeValue)&&(i?o[a].nodeValue="":(o[a].nodeValue=n[gTextProp],i=!0));if(!i){var s=document.createTextNode(n[gTextProp]);e.insertBefore(s,e.firstChild)}}delete n[gTextProp]}for(var l in n)e[l]=n[l]}else consoleWarn("#"+t.id+" is undefined.")}}function getChildElementCount(e){if(e.children)return e.children.length;if(void 0!==e.childElementCount)return e.childElementCount;for(var t=0,n=0;n<e.childNodes.length;n++)t+=1===e.nodeType?1:0;return t}function translateFragment(e){for(var t=getTranslatableChildren(e=e||document.documentElement),n=t.length,o=0;o<n;o++)translateElement(t[o]);translateElement(e)}function l10nStartup(){gReadyState="interactive";var e=navigator.language||navigator.userLanguage;consoleLog("loading ["+e+"] resources, "+(gAsyncResourceLoading?"asynchronously.":"synchronously.")),document.documentElement.lang===e?loadLocale(e):loadLocale(e,translateFragment)}return gMacros.plural=function(e,t,n,o){var i=parseFloat(t);if(isNaN(i))return e;if(o!=gTextProp)return e;gMacros._pluralRules||(gMacros._pluralRules=getPluralRules(gLanguage));var a="["+gMacros._pluralRules(i)+"]";return 0===i&&n+"[zero]"in gL10nData?e=gL10nData[n+"[zero]"][o]:1==i&&n+"[one]"in gL10nData?e=gL10nData[n+"[one]"][o]:2==i&&n+"[two]"in gL10nData?e=gL10nData[n+"[two]"][o]:n+a in gL10nData?e=gL10nData[n+a][o]:n+"[other]"in gL10nData&&(e=gL10nData[n+"[other]"][o]),e},document.addEventListener?"loading"===document.readyState?document.addEventListener("DOMContentLoaded",l10nStartup):window.setTimeout(l10nStartup):window.attachEvent&&(window.console||(consoleLog=consoleWarn=function(e){}),window.XMLHttpRequest||(xhrLoadText=function(e,t,n,o){t=t||function(){},n=n||function(){consoleWarn(e+" not found.")};var i=new ActiveXObject("Microsoft.XMLHTTP");i.open("GET",e,o),i.onreadystatechange=function(){4==i.readyState&&(200==i.status?t(i.responseText):n())},i.send(null)}),window.JSON||(getL10nAttributes=function(element){if(!element)return{};var l10nId=element.getAttribute("data-l10n-id"),l10nArgs=element.getAttribute("data-l10n-args"),args={};if(l10nArgs)try{args=eval(l10nArgs)}catch(e){consoleWarn("could not parse arguments for #"+l10nId)}return{id:l10nId,args:args}}),document.querySelectorAll||(getTranslatableChildren=function(e){if(!e)return[];for(var t=e.getElementsByTagName("*"),n=[],o=t.length,i=0;i<o;i++)t[i].getAttribute("data-l10n-id")&&n.push(t[i]);return n},getL10nResourceLinks=function(){for(var e=document.getElementsByTagName("link"),t=[],n=e.length,o=0;o<n;o++)"application/l10n"==e[o].type&&t.push(e[o]);return t}),window.JSON&&document.querySelectorAll||(getL10nDictionary=function(){for(var scripts=document.getElementsByName("script"),i=0;i<scripts.length;i++)if("application/l10n"==scripts[i].type)return eval(scripts[i].innerHTML);return null}),document.createEventObject&&!document.createEvent&&(fireL10nReadyEvent=function(e){document.documentElement.localized=1}),window.attachEvent("onload",function(){gTextProp=document.body.textContent?"textContent":"innerText",l10nStartup()})),{get:function(e,t,n){var o=getL10nData(e,t)||n;return o?gTextProp in o?o[gTextProp]:"":"{{"+e+"}}"},getData:function(){return gL10nData},getText:function(){return gTextData},getLanguage:function(){return gLanguage},setLanguage:function(e){loadLocale(e,translateFragment)},getDirection:function(){return 0<=["ar","he","fa","ps","ur"].indexOf(gLanguage)?"rtl":"ltr"},translate:translateFragment,getReadyState:function(){return gReadyState},ready:function(t){t&&("complete"==gReadyState||"interactive"==gReadyState?window.setTimeout(t):document.addEventListener?document.addEventListener("localized",t):document.attachEvent&&document.documentElement.attachEvent("onpropertychange",function(e){"localized"===e.propertyName&&t()}))}}}(window,document),void 0===window._)var _=document.webL10n.get;!function(e){function t(e){var n,a={};function r(e){i.push(e),s||d()}function t(e){var t=s.callback;s=null,t&&t.call(a,e.data),i.length&&d()}function o(e){var t=s.callback;delete s.callback,t&&t.call(a,e.data),s=null,i.length&&d()}(e=e||{}).workerUrl=e.workerUrl||"wordfreq.worker.js";var i=[],s=null,l=!1,d=function(){s=i.shift(),n.postMessage({method:s.method,params:s.params}),delete s.method,delete s.params};return["process","empty","getList","getLength","getVolume"].forEach(function(i){a[i]=function(){if(!l){var e,t=arguments.length;"function"==typeof arguments[arguments.length-1]&&(e=arguments[arguments.length-1],t--);for(var n=[],o=0;o<t;)n[o]=arguments[o],o++;return r({method:i,params:n,callback:e}),a}}}),a.stop=function(e){if(!l){if(l=!0,n.terminate(),n.onmessage=null,n.onerror=null,n=null,!e)return s=null,i=[],a;for(s&&s.callback&&s.callback.call(a),s=null;i.length;){var t=i.shift();t.callback&&t.callback.call(a)}return a}},(n=new Worker(e.workerUrl)).onmessage=t,n.onerror=o,r({method:"init",params:[e]}),a}t.isSupported=!!(e.Worker&&Array.prototype.push&&Array.prototype.indexOf&&Array.prototype.forEach&&Array.isArray&&Object.create),"function"==typeof define&&define.amd?define("wordfreq",[],function(){return t}):e.WordFreq=t}(this),window.setImmediate||(window.setImmediate=window.msSetImmediate||window.webkitSetImmediate||window.mozSetImmediate||window.oSetImmediate||function(){if(!window.postMessage||!window.addEventListener)return null;var n=[void 0],o="zero-timeout-message";return window.addEventListener("message",function(e){if("string"==typeof e.data&&e.data.substr(0,o.length)===o){e.stopImmediatePropagation();var t=parseInt(e.data.substr(o.length),36);n[t]&&(n[t](),n[t]=void 0)}},!0),window.clearImmediate=function(e){n[e]&&(n[e]=void 0)},function(e){var t=n.length;return n.push(e),window.postMessage(o+t.toString(36),"*"),t}}()||function(e){window.setTimeout(e,0)}),window.clearImmediate||(window.clearImmediate=window.msClearImmediate||window.webkitClearImmediate||window.mozClearImmediate||window.oClearImmediate||function(e){window.clearTimeout(e)}),function(e){function p(e){for(var t,n,o=e.length;o;t=Math.floor(Math.random()*o),n=e[--o],e[o]=e[t],e[t]=n);return e}function t(g,e){if(s){Array.isArray(g)||(g=[g]),g.forEach(function(e,t){if("string"==typeof e){if(g[t]=document.getElementById(e),!g[t])throw"The element id specified is not found."}else if(!e.tagName&&!e.appendChild)throw"You must pass valid HTML elements, or ID of the element."});var k={list:[],fontFamily:'"Trebuchet MS", "Heiti TC", "微軟正黑體", "Arial Unicode MS", "Droid Fallback Sans", sans-serif',fontWeight:"normal",color:"random-dark",minSize:0,weightFactor:1,clearCanvas:!0,backgroundColor:"#fff",gridSize:8,drawOutOfBound:!1,origin:null,drawMask:!1,maskColor:"rgba(255,0,0,0.3)",maskGapWidth:.3,wait:0,abortThreshold:0,abort:function(){},minRotation:-Math.PI/2,maxRotation:Math.PI/2,shuffle:!0,rotateRatio:.1,shape:"circle",ellipticity:.65,classes:null,hover:null,click:null};if(e)for(var t in e)t in k&&(k[t]=e[t]);if("function"!=typeof k.weightFactor){var n=k.weightFactor;k.weightFactor=function(e){return e*n}}if("function"!=typeof k.shape)switch(k.shape){case"circle":default:k.shape="circle";break;case"cardioid":k.shape=function(e){return 1-Math.sin(e)};break;case"diamond":case"square":k.shape=function(e){var t=e%(2*Math.PI/4);return 1/(Math.cos(t)+Math.sin(t))};break;case"triangle-forward":k.shape=function(e){var t=e%(2*Math.PI/3);return 1/(Math.cos(t)+Math.sqrt(3)*Math.sin(t))};break;case"triangle":case"triangle-upright":k.shape=function(e){var t=(e+3*Math.PI/2)%(2*Math.PI/3);return 1/(Math.cos(t)+Math.sqrt(3)*Math.sin(t))};break;case"pentagon":k.shape=function(e){var t=(e+.955)%(2*Math.PI/5);return 1/(Math.cos(t)+.726543*Math.sin(t))};break;case"star":k.shape=function(e){var t=(e+.955)%(2*Math.PI/10);return 0<=(e+.955)%(2*Math.PI/5)-2*Math.PI/10?1/(Math.cos(2*Math.PI/10-t)+3.07768*Math.sin(2*Math.PI/10-t)):1/(Math.cos(t)+3.07768*Math.sin(t))}}k.gridSize=Math.max(Math.floor(k.gridSize),4);var w,f,E,v,b,A,y,I=k.gridSize,a=I-k.maskGapWidth,h=Math.abs(k.maxRotation-k.minRotation),c=Math.min(k.maxRotation,k.minRotation);switch(k.color){case"random-dark":y=function(){return i(10,50)};break;case"random-light":y=function(){return i(50,90)};break;default:"function"==typeof k.color&&(y=k.color)}var S=null;"function"==typeof k.classes&&(S=k.classes);function o(e){var t,n,o=e.currentTarget,i=o.getBoundingClientRect();n=e.touches?(t=e.touches[0].clientX,e.touches[0].clientY):(t=e.clientX,e.clientY);var a=t-i.left,r=n-i.top,s=Math.floor(a*(o.width/i.width||1)/I),l=Math.floor(r*(o.height/i.height||1)/I);return V[s][l]}function L(e){var t=o(e);B!==t&&((B=t)?k.hover(t.item,t.dimension,e):k.hover(void 0,void 0,e))}function D(e){var t=o(e);t&&(k.click(t.item,t.dimension,e),e.preventDefault())}function u(e){if(r[e])return r[e];var t=8*e,n=t,o=[];for(0===e&&o.push([v[0],v[1],0]);n--;){var i=1;"circle"!==k.shape&&(i=k.shape(n/t*2*Math.PI)),o.push([v[0]+e*i*Math.cos(-n/t*2*Math.PI),v[1]+e*i*Math.sin(-n/t*2*Math.PI)*k.ellipticity,n/t*2*Math.PI])}return r[e]=o}function T(){return 0<k.abortThreshold&&(new Date).getTime()-A>k.abortThreshold}function m(e,t,n,o,i){if(!(f<=e||E<=t||e<0||t<0)){if(w[e][t]=!1,n)g[0].getContext("2d").fillRect(e*I,t*I,a,a);R&&(V[e][t]={item:i,dimension:o})}}function C(o){var i,a,r;Array.isArray(o)?(i=o[0],a=o[1]):(i=o.word,a=o.weight,r=o.attributes);var s=0===k.rotateRatio?0:Math.random()>k.rotateRatio?0:0===h?c:c+Math.random()*h,l=function(e,t,n){var o=k.weightFactor(t);if(o<=k.minSize)return!1;var i=1;o<U&&(i=function(){for(var e=2;e*o<U;)e+=2;return e}());var a=document.createElement("canvas"),r=a.getContext("2d",{willReadFrequently:!0});r.font=k.fontWeight+" "+(o*i).toString(10)+"px "+k.fontFamily;var s=r.measureText(e).width/i,l=Math.max(o*i,r.measureText("m").width,r.measureText("Ｗ").width)/i,d=s+2*l,h=3*l,c=Math.ceil(d/I),u=Math.ceil(h/I);d=c*I,h=u*I;var p=-s/2,m=.4*-l,w=Math.ceil((d*Math.abs(Math.sin(n))+h*Math.abs(Math.cos(n)))/I),f=Math.ceil((d*Math.abs(Math.cos(n))+h*Math.abs(Math.sin(n)))/I),g=f*I,E=w*I;a.setAttribute("width",g),a.setAttribute("height",E),r.scale(1/i,1/i),r.translate(g*i/2,E*i/2),r.rotate(-n),r.font=k.fontWeight+" "+(o*i).toString(10)+"px "+k.fontFamily,r.fillStyle="#000",r.textBaseline="middle",r.fillText(e,p*i,(m+.5*o)*i);var v=r.getImageData(0,0,g,E).data;if(T())return!1;for(var b,A,y,S=[],L=f,D=[w/2,f/2,w/2,f/2];L--;)for(b=w;b--;){y=I;e:{for(;y--;)for(A=I;A--;)if(v[4*((b*I+y)*g+(L*I+A))+3]){S.push([L,b]),L<D[3]&&(D[3]=L),L>D[1]&&(D[1]=L),b<D[0]&&(D[0]=b),b>D[2]&&(D[2]=b);break e}0}}return{mu:i,occupied:S,bounds:D,gw:f,gh:w,fillTextOffsetX:p,fillTextOffsetY:m,fillTextWidth:s,fillTextHeight:l,fontSize:o}}(i,a,s);if(!l)return!1;if(T())return!1;if(!k.drawOutOfBound){var e=l.bounds;if(e[1]-e[3]+1>f||e[2]-e[0]+1>E)return!1}function t(e){var t=Math.floor(e[0]-l.gw/2),n=Math.floor(e[1]-l.gh/2);return l.gw,l.gh,!!function(e,t,n,o,i){for(var a=i.length;a--;){var r=e+i[a][0],s=t+i[a][1];if(f<=r||E<=s||r<0||s<0){if(!k.drawOutOfBound)return!1}else if(!w[r][s])return!1}return!0}(t,n,0,0,l.occupied)&&(function(l,d,h,c,e,t,n,u,p){var m,w,f=h.fontSize;m=y?y(c,e,f,t,n):k.color,w=S?S(c,e,f,t,n):k.classes;var o=h.bounds;o[3],o[0],o[1],o[3],o[2],o[0],g.forEach(function(e){if(e.getContext){var t=e.getContext("2d"),n=h.mu;t.save(),t.scale(1/n,1/n),t.font=k.fontWeight+" "+(f*n).toString(10)+"px "+k.fontFamily,t.fillStyle=m,t.translate((l+h.gw/2)*I*n,(d+h.gh/2)*I*n),0!==u&&t.rotate(-u),t.textBaseline="middle",t.fillText(c,h.fillTextOffsetX*n,(h.fillTextOffsetY+.5*f)*n),t.restore()}else{var o=document.createElement("span"),i="";i="rotate("+-u/Math.PI*180+"deg) ",1!==h.mu&&(i+="translateX(-"+h.fillTextWidth/4+"px) scale("+1/h.mu+")");var a={position:"absolute",display:"block",font:k.fontWeight+" "+f*h.mu+"px "+k.fontFamily,left:(l+h.gw/2)*I+h.fillTextOffsetX+"px",top:(d+h.gh/2)*I+h.fillTextOffsetY+"px",width:h.fillTextWidth+"px",height:h.fillTextHeight+"px",lineHeight:f+"px",whiteSpace:"nowrap",transform:i,webkitTransform:i,msTransform:i,transformOrigin:"50% 40%",webkitTransformOrigin:"50% 40%",msTransformOrigin:"50% 40%"};for(var r in m&&(a.color=m),o.textContent=c,a)o.style[r]=a[r];if(p)for(var s in p)o.setAttribute(s,p[s]);w&&(o.className+=w),e.appendChild(o)}})}(t,n,l,i,a,b-d,e[2],s,r),function(e,t,n,o,i,a){var r,s,l=i.occupied,d=k.drawMask;if(d&&((r=g[0].getContext("2d")).save(),r.fillStyle=k.maskColor),R){var h=i.bounds;s={x:(e+h[3])*I,y:(t+h[0])*I,w:(h[1]-h[3]+1)*I,h:(h[2]-h[0]+1)*I}}for(var c=l.length;c--;){var u=e+l[c][0],p=t+l[c][1];f<=u||E<=p||u<0||p<0||m(u,p,d,s,a)}d&&r.restore()}(t,n,0,0,l,o),!0)}for(var d=b+1;d--;){var n=u(b-d);if(k.shuffle&&(n=[].concat(n),p(n)),n.some(t))return!0}return!1}function _(n,o,i){if(o)return!g.some(function(e){var t=document.createEvent("CustomEvent");return t.initCustomEvent(n,!0,o,i||{}),!e.dispatchEvent(t)},this);g.forEach(function(e){var t=document.createEvent("CustomEvent");t.initCustomEvent(n,!0,o,i||{}),e.dispatchEvent(t)},this)}var B,R=!1,V=[],r=[];!function(){var t=g[0];if(t.getContext)f=Math.ceil(t.width/I),E=Math.ceil(t.height/I);else{var e=t.getBoundingClientRect();f=Math.ceil(e.width/I),E=Math.ceil(e.height/I)}if(_("wordcloudstart",!0)){var n,o,i,a,r;if(v=k.origin?[k.origin[0]/I,k.origin[1]/I]:[f/2,E/2],b=Math.floor(Math.sqrt(f*f+E*E)),w=[],!t.getContext||k.clearCanvas)for(g.forEach(function(e){if(e.getContext){var t=e.getContext("2d");t.fillStyle=k.backgroundColor,t.clearRect(0,0,f*(I+1),E*(I+1)),t.fillRect(0,0,f*(I+1),E*(I+1))}else e.textContent="",e.style.backgroundColor=k.backgroundColor}),n=f;n--;)for(w[n]=[],o=E;o--;)w[n][o]=!0;else{var s=document.createElement("canvas").getContext("2d");s.fillStyle=k.backgroundColor,s.fillRect(0,0,1,1);var l,d,h=s.getImageData(0,0,1,1).data,c=t.getContext("2d").getImageData(0,0,f*I,E*I).data;for(n=f;n--;)for(w[n]=[],o=E;o--;){d=I;e:for(;d--;)for(l=I;l--;)for(i=4;i--;)if(c[4*((o*I+d)*f*I+(n*I+l))+i]!==h[i]){w[n][o]=!1;break e}!1!==w[n][o]&&(w[n][o]=!0)}c=s=h=void 0}if(k.hover||k.click){for(R=!0,n=f+1;n--;)V[n]=[];k.hover&&t.addEventListener("mousemove",L),k.click&&(t.addEventListener("click",D),t.addEventListener("touchstart",D),t.addEventListener("touchend",function(e){e.preventDefault()}),t.style.webkitTapHighlightColor="rgba(0, 0, 0, 0)"),t.addEventListener("wordcloudstart",function e(){t.removeEventListener("wordcloudstart",e),t.removeEventListener("mousemove",L),t.removeEventListener("click",D),B=void 0})}r=(i=0)!==k.wait?(a=window.setTimeout,window.clearTimeout):(a=window.setImmediate,window.clearImmediate);function u(t,n){g.forEach(function(e){e.removeEventListener(t,n)},this)}function p(){u("wordcloudstart",p),r(m)}!function(t,n){g.forEach(function(e){e.addEventListener(t,n)},this)}("wordcloudstart",p);var m=a(function e(){if(i>=k.list.length)return r(m),_("wordcloudstop",!1),void u("wordcloudstart",p);A=(new Date).getTime();var t=C(k.list[i]),n=!_("wordclouddrawn",!0,{item:k.list[i],drawn:t});if(T()||n)return r(m),k.abort(),_("wordcloudabort",!1),_("wordcloudstop",!1),void u("wordcloudstart",p);i++,m=a(e,k.wait)},k.wait)}}()}function i(e,t){return"hsl("+(360*Math.random()).toFixed()+","+(30*Math.random()+70).toFixed()+"%,"+(Math.random()*(t-e)+e).toFixed()+"%)"}}var s=function(){var e=document.createElement("canvas");if(!e||!e.getContext)return!1;var t=e.getContext("2d");return!!t.getImageData&&(!!t.fillText&&(!!Array.prototype.some&&!!Array.prototype.push))}(),U=function(){if(s){for(var e,t,n=document.createElement("canvas").getContext("2d"),o=20;o;){if(n.font=o.toString(10)+"px sans-serif",n.measureText("Ｗ").width===e&&n.measureText("m").width===t)return o+1;e=n.measureText("Ｗ").width,t=n.measureText("m").width,o--}return 0}}();t.isSupported=s,t.minFontSize=U,"function"==typeof define&&define.amd?define("wordcloud",[],function(){return t}):"undefined"!=typeof module&&module.exports?module.exports=t:e.WordCloud=t}(this);var WordCloudApp=function(){if(!((window.WordFreq&&window.WordFreq.isSupported||window.WordFreqSync&&window.WordFreqSync.isSupported)&&WordCloud.isSupported&&Object.keys&&Array.prototype.map&&Array.prototype.forEach&&Array.prototype.indexOf&&Function.prototype.bind&&"onhashchange"in window))return window.onload=function(){var e=document.getElementById("wc-browser-support");try{delete e.hidden}catch(e){}e.removeAttribute&&e.removeAttribute("hidden")},this.isSupported=!1,void this.logAction("WordCloudApp::isSupported::false");this.isSupported=!0,this.logAction("WordCloudApp::isSupported::true"),this.isFullySupported=function(){if(!FilePanelView.prototype.isSupported)return!1;if(window.HTMLCanvasElement.prototype.toBlob)return!0;var e=window.Blob&&function(){try{return Boolean(new Blob)}catch(e){return!1}}(),t=window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder;return!!((e||t)&&window.atob&&window.ArrayBuffer&&window.Uint8Array)}(),this.logAction("WordCloudApp::isFullySupported::"+this.isFullySupported),window.addEventListener("load",this),this.fetchers={},this.views={},this.currentUIState=this.UI_STATE_LOADING,this.UIStateViewMap=[["loading"],["canvas","source-dialog"],["loading","dashboard"],["canvas","dashboard"],["canvas","dashboard","list-dialog"],["loading","dashboard"],["canvas","dashboard","sharer-dialog"],["canvas","about-dialog"]],this.wordfreqOption={workerUrl:"./assets/wordfreq/src/wordfreq.worker.js?_=k3j9i8ln"},this.shapes=[{shape:"circle"},{shape:function(e){var t=(e+Math.PI/4)%(2*Math.PI/4);return 1/(Math.cos(t)+Math.sin(t))}},{shape:"triangle-forward",ellipticity:1},{shape:"star",ellipticity:1}];function e(e){return function(){return e[Math.floor(Math.random()*e.length)]}}var t='"Trebuchet MS", "Heiti TC", "微軟正黑體", "Arial Unicode MS", "Droid Fallback Sans", sans-serif',n='Baskerville, "Times New Roman", "華康儷金黑 Std", "華康儷宋 Std",  DFLiKingHeiStd-W8, DFLiSongStd-W5, "Hiragino Mincho Pro", "LiSong Pro Light", "新細明體", serif';this.themes=[{fontFamily:n,color:e(["#66d9ef","#a6e22d","#fd9720","#a6e22a","#a581ff","#f92772"]),backgroundColor:"#272822"},{fontFamily:t,color:e(["#07ABDA","#63D6F6","#0F7BDC","#69B4F7","#00DBB6","#376F65","#004438","#5FF7DD"]),backgroundColor:"#AAF7EA"},{fontFamily:n,color:e(["#2F55D1","#4058A5","#133193","#98AFFD"]),backgroundColor:"#e3e9fd"},{fontFamily:t,color:e(["#c30000","#c37a00","#650281","#de3333","#de5c5c","#7e602c","#633e00","#481e53"]),backgroundColor:"#edd1a4"},{fontFamily:t,color:function(){return"rgb("+Math.floor(128*Math.random()+48).toString(10)+","+Math.floor(128*Math.random()+48).toString(10)+","+Math.floor(128*Math.random()+48).toString(10)+")"},backgroundColor:"#eee"},{fontFamily:n,color:"random-light",backgroundColor:"#000"},{fontFamily:n,color:e(["#3a3f42","#575d51","#42361d"]),backgroundColor:"#8d8380"},{fontFamily:n,color:e(["#f7e4be","#f0f4bc","#9a80a4","#848da6"]),backgroundColor:"#223564"},{fontFamily:n,color:"#d0d0d0",backgroundColor:"#999"},{fontFamily:t,color:"rgba(255,255,255,0.8)",backgroundColor:"#353130"},{fontFamily:t,color:"rgba(0,0,0,0.7)",backgroundColor:"rgba(255, 255, 255, 1)"}],this.data={theme:0,shape:0,gridSize:void 0,weightFactor:void 0,drawOutOfBound:!0}};WordCloudApp.prototype.addView=function(e){(this.views[e.name]=e).app=this},WordCloudApp.prototype.addFetcher=function(t){t.types.forEach(function(e){this.fetchers[e]=t}.bind(this)),t.app=this},WordCloudApp.prototype.pushUrlHash=function(e){if(e===window.location.hash)return this.route(),!0;this.backToReset=!window.location.hash.substr(1),this.lastUrlHashChangePushedByScript=!0;try{window.location.hash=e}catch(e){return!1}return!0},WordCloudApp.prototype.reset=function(){window.location.hash.substr(1)&&(this.backToReset?window.history.back():this.pushUrlHash(""))},WordCloudApp.prototype.UI_STATE_LOADING=0,WordCloudApp.prototype.UI_STATE_SOURCE_DIALOG=1,WordCloudApp.prototype.UI_STATE_WORKING=2,WordCloudApp.prototype.UI_STATE_DASHBOARD=3,WordCloudApp.prototype.UI_STATE_LIST_DIALOG=4,WordCloudApp.prototype.UI_STATE_ERROR_WITH_DASHBOARD=5,WordCloudApp.prototype.UI_STATE_SHARER_DIALOG=6,WordCloudApp.prototype.UI_STATE_ABOUT_DIALOG=7,WordCloudApp.prototype.switchUIState=function(t){if(!this.UIStateViewMap[t])throw"Undefined state "+t;document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur();var e=Object.keys(this.views),n=this.currentUIState;e.forEach(function(e){this.views[e][-1!==this.UIStateViewMap[t].indexOf(e)?"show":"hide"](n,t)}.bind(this)),this.currentUIState=t},WordCloudApp.prototype.handleData=function(o,e){if(this.logAction("WordCloudApp::handleData",e+" ("+o.length+")"),!o.length)return this.switchUIState(this.UI_STATE_ERROR_WITH_DASHBOARD),void this.views.loading.updateLabel(this.views.loading.LABEL_ERROR_DATA);var t;this.currentFetcher=void 0,this.views.loading.updateLabel(this.views.loading.LABEL_ANALYZING),this.data.title=e,WordFreq?this.wordfreq=WordFreq(this.wordfreqOption).process(o).getVolume(function(e){t=e}).getList(function(e){this.wordfreq=void 0,this.handleList(e,t)}.bind(this)):this.wordfreq=setTimeout(function(){var e=WordFreqSync(this.wordfreqOption),t=e.process(o),n=e.getVolume();this.wordfreq=void 0,this.handleList(t,n)}.bind(this))},WordCloudApp.prototype.stopHandleData=function(){this.wordfreq&&("object"==typeof this.wordfreq?this.wordfreq.stop(!1):clearTimeout(this.wordfreq),this.wordfreq=void 0)},WordCloudApp.prototype.handleList=function(e,t){if(this.logAction("WordCloudApp::handleList",e.length),!e.length)return this.switchUIState(this.UI_STATE_ERROR_WITH_DASHBOARD),void this.views.loading.updateLabel(this.views.loading.LABEL_ERROR_LIST);this.switchUIState(this.UI_STATE_DASHBOARD),this.data.list=e,this.data.gridSize=4,this.data.theme=Math.floor(Math.random()*this.themes.length),this.calculateWeightFactor(t),this.draw()},WordCloudApp.prototype.draw=function(){var e=this.views.canvas;e.setDimension(),e.draw(this.getWordCloudOption());var t=this.parseHash();this.logAction("WordCloudApp::draw::"+t[0],t[1].substr(0,128))},WordCloudApp.prototype.getCanvasElement=function(){return this.views.canvas.canvasElement},WordCloudApp.prototype.calculateWeightFactor=function(e){var t=this.views.canvas.documentWidth,n=this.views.canvas.documentHeight;this.data.weightFactor=Math.sqrt(t*n/e)},WordCloudApp.prototype.getWordCloudOption=function(){var t={};return Object.keys(this.data).forEach(function(e){t[e]=this.data[e]}.bind(this)),Object.keys(this.themes[this.data.theme]).forEach(function(e){t[e]=this.themes[this.data.theme][e]}.bind(this)),Object.keys(this.shapes[this.data.shape]).forEach(function(e){t[e]=this.shapes[this.data.shape][e]}.bind(this)),t},WordCloudApp.prototype.showSharer=function(){this.switchUIState(this.UI_STATE_SHARER_DIALOG)},WordCloudApp.prototype.route=function(){var e=window.location.hash.substr(1);if(this.backToReset&&!this.lastUrlHashChangePushedByScript&&(this.backToReset=!1),this.lastUrlHashChangePushedByScript=!1,this.currentFetcher&&(this.currentFetcher.stop(),this.currentFetcher=void 0),this.stopHandleData(),!e)return this.switchUIState(this.UI_STATE_SOURCE_DIALOG),void this.logAction("WordCloudApp::route::source-dialog");var t=this.parseHash(),n=t[0],o=t[1];t=void 0,this.logAction("WordCloudApp::route::"+n,o.substr(0,128));var i=-1===n.indexOf(".")?n:n.split(".")[0];if(i in this.fetchers){this.switchUIState(this.UI_STATE_WORKING);var a=this.currentFetcher=this.fetchers[i];this.views.loading.updateLabel(a.LABEL_VERB),a.getData(n,o)}else this.reset()},WordCloudApp.prototype.logAction=function(e,t,n){if(window._gaq){var o=["_trackEvent","Word Cloud"];void 0!==e&&(o.push(e.toString()),void 0!==t&&(o.push(t.toString()),void 0!==n&&o.push(parseFloat(n,10)))),window._gaq.push(o)}},WordCloudApp.prototype.parseHash=function(){var n,o;return window.location.hash.substr(1).match(/^([^:]+):?(.*)$/).forEach(function(e,t){switch(t){case 1:n=e;break;case 2:o=e}}),[n,o]},WordCloudApp.prototype.handleEvent=function(e){switch(e.type){case"load":window.removeEventListener("load",this),window.addEventListener("hashchange",this),this.route();break;case"hashchange":this.route()}},WordCloudApp.prototype.uninit=function(){window.removeEventListener("load",this),window.removeEventListener("hashchange",this)};var FacebookSDKLoader=function(){if(!FACEBOOK_APP_ID)throw"No FACEBOOK_APP_ID defined.";this.loaded=!1};FacebookSDKLoader.prototype.load=function(e){if(this.loaded)throw"FacebookSDKLoader shouldn't be reused.";if(this.loaded=!0,window.FB)e();else if(window.fbAsyncInit){var t=window.fbAsyncInit;window.fbAsyncInit=function(){window.fbAsyncInit=null,t(),e()}.bind(this)}else{var n,o,i,a,r,s=document.createElement("div");s.id="fb-root",document.body.insertBefore(s,document.body.firstChild),n=document,o="script",i="facebook-jssdk",r=n.getElementsByTagName(o)[0],n.getElementById(i)||((a=n.createElement(o)).id=i,a.src="//connect.facebook.net/en_US/all.js",r.parentNode.insertBefore(a,r));var l=window.FACEBOOK_CHANNEL_URL||document.location.href.replace(/\/(index.html)?(#.*)?$/i,"/facebook-channel.html");window.fbAsyncInit=function(){window.fbAsyncInit=null,FB.init({appId:FACEBOOK_APP_ID,channelUrl:l}),e()}}};var View=function(){};View.prototype.load=function(e,t){for(var n in e=e||{},t){if(n in this)break;this[n]=n in e?e[n]:t[n],"element"!==n&&!/Element$/.test(n)||(this[n]="string"==typeof this[n]?document.getElementById(this[n]):this[n])}},View.prototype.show=function(e,t){return!("beforeShow"in this&&!1===this.beforeShow.apply(this,arguments))&&(this.element.removeAttribute("hidden"),"afterShow"in this&&this.afterShow.apply(this,arguments),!0)},View.prototype.hide=function(e,t){return!("beforeHide"in this&&!1===this.beforeHide.apply(this,arguments))&&(this.element.setAttribute("hidden",!0),"afterHide"in this&&this.afterHide.apply(this,arguments),!0)};var LanguageSwitcherView=function(e){this.load(e,{element:"wc-language"});var t=navigator.language||navigator.userLanguage;t=t.replace(/-[a-z]{2}$/i,function(e){return e.toUpperCase()});var n=this.langs=[];Array.prototype.forEach.call(this.element.children,function(e){n.push(e.value),e.value===t&&(e.selected=!0)}),-1===n.indexOf(t)&&(this.element.selectedIndex=0),document.addEventListener("localized",this),this.element.addEventListener("change",this)};LanguageSwitcherView.prototype=new View,LanguageSwitcherView.prototype.handleEvent=function(e){switch(e.type){case"change":document.webL10n.setLanguage(this.element.value),this.app.logAction("LanguageSwitcherView::change",this.element.value);break;case"localized":this.app.logAction("LanguageSwitcherView::localized",document.documentElement.lang)}};var LoadingView=function(e){this.load(e,{name:"loading",element:"wc-loading",labelElement:"wc-loading-label"}),this.stringIds=["downloading","loading","analyzing","no_data","no_list_output"]};LoadingView.prototype=new View,LoadingView.prototype.LABEL_DOWNLOADING=0,LoadingView.prototype.LABEL_LOADING=1,LoadingView.prototype.LABEL_ANALYZING=2,LoadingView.prototype.LABEL_ERROR_DATA=3,LoadingView.prototype.LABEL_ERROR_LIST=4,LoadingView.prototype.beforeShow=function(e,t){t===this.app.UI_STATE_ERROR_WITH_DASHBOARD?this.element.className="error":this.element.className=""},LoadingView.prototype.updateLabel=function(e){if(!this.stringIds[e])throw"Undefined stringId "+e;this.labelElement.setAttribute("data-l10n-id",this.stringIds[e]),__(this.labelElement)};var ListDialogView=function(e){this.load(e,{name:"list-dialog",element:"wc-list-dialog",textElement:"wc-list-edit",cancelBtnElement:"wc-list-cancel-btn",confirmBtnElement:"wc-list-confirm-btn"}),this.cancelBtnElement.addEventListener("click",this),this.confirmBtnElement.addEventListener("click",this)};ListDialogView.prototype=new View,ListDialogView.prototype.beforeShow=function(){this.textElement.value=this.app.data.list.map(function(e){return e[1]+"\t"+e[0]}).join("\n")},ListDialogView.prototype.afterShow=function(){this.textElement.focus()},ListDialogView.prototype.handleEvent=function(e){switch(e.target){case this.confirmBtnElement:this.submit();break;case this.cancelBtnElement:this.close()}},ListDialogView.prototype.submit=function(){var e,t=this.textElement;e=window.btoa?"#base64-list:"+window.btoa(unescape(encodeURIComponent(t.value))):"#list:"+encodeURIComponent(t.value),this.app.pushUrlHash(e)||this.app.pushUrlHash("#list")},ListDialogView.prototype.close=function(){this.app.switchUIState(this.app.UI_STATE_DASHBOARD)};var AboutDialogView=function(e){this.load(e,{name:"about-dialog",element:"wc-about-dialog",donateElement:"wc-about-donate",donateContentElement:"wc-about-donate-content",contentElement:"wc-about-content",closeBtnElement:"wc-about-close-btn"}),this.loaded=!1,this.closeBtnElement.addEventListener("click",this),this.contentElement.addEventListener("click",this),this.donateContentElement.addEventListener("submit",this),document.addEventListener("localized",this)};AboutDialogView.prototype=new View,AboutDialogView.prototype.beforeShow=function(){this.app.logAction("AboutDialogView::view"),this.loaded=!0;var e=document.documentElement.lang;this.loadContent(e,!0)},AboutDialogView.prototype.loadContent=function(e,t){var o=document.createElement("iframe");o.src="about."+e+".html",this.contentElement.appendChild(o),o.onload=function(){for(var e=document.importNode(o.contentWindow.document.body,!0),t=document.createDocumentFragment();e.firstElementChild;)t.appendChild(e.firstElementChild);for(var n=this.contentElement;n.firstChild;)n.removeChild(n.firstChild);n.appendChild(t)}.bind(this),t&&(o.onerror=function(){this.loaded=!1,this.element.hasAttribute("hidden")||this.app.switchUIState(this.app.UI_STATE_SOURCE_DIALOG)}.bind(this)),window.DONATE_HTML&&(this.donateElement.removeAttribute("hidden"),this.donateContentElement.innerHTML=window.DONATE_HTML.replace(/%lang/,e.replace(/-/,"_")))},AboutDialogView.prototype.handleEvent=function(e){if("localized"!==e.type)switch(e.currentTarget){case this.contentElement:if("A"!==e.target.tagName)break;e.preventDefault(),window.open(e.target.href),this.app.logAction("AboutDialogView::externalLink",e.target.href);break;case this.donateContentElement:this.app.logAction("AboutDialogView::donateLink");break;case this.closeBtnElement:this.close()}else this.loaded=!1},AboutDialogView.prototype.close=function(){this.app.switchUIState(this.app.UI_STATE_SOURCE_DIALOG)};var SNSPushView=function(e){this.load(e,{name:"sns-push",element:"wc-sns-push",facebookElement:"wc-sns-facebook"}),"1"!==navigator.doNotTrack&&("complete"===document.webL10n.getReadyState()&&this.loadButtons(),window.addEventListener("localized",this))};SNSPushView.prototype=new View,SNSPushView.prototype.FACEBOOK_BUTTON_URL="https://www.facebook.com/plugins/like.php?href=%url&layout=box_count&show_faces=false&width=55&action=like&font=trebuchet+ms&colorscheme=light&height=65&locale=%lang",SNSPushView.prototype.beforeShow=function(){return"1"!==navigator.doNotTrack},SNSPushView.prototype.loadButtons=function(){var e=window.location.href;-1!==e.indexOf("#")&&(e=e.replace(/#.*$/,"").replace(/\?.*$/,""));var t=document.documentElement.lang;this.updateFrame(this.facebookElement,this.FACEBOOK_BUTTON_URL.replace(/%url/,encodeURIComponent(e)).replace(/%lang/,t.replace(/-/,"_")))},SNSPushView.prototype.updateFrame=function(e,t){for(;e.firstElementChild;)e.removeChild(e.firstElementChild);var n=document.createElement("iframe");n.src=t,n.setAttribute("scrolling","no"),n.setAttribute("frameborder","0"),n.setAttribute("allowTransparency","true"),e.appendChild(n)},SNSPushView.prototype.handleEvent=function(e){switch(e.type){case"localized":this.loadButtons()}};var PSMView=function(e){this.load(e,{name:"psm",element:"wc-psm"}),"complete"===document.webL10n.getReadyState()&&this.loadFrame(),window.addEventListener("localized",this)};PSMView.prototype=new View,PSMView.prototype.URL="//timdream.org/psm/#locale=%lang",PSMView.prototype.loadFrame=function(){for(var e=document.documentElement.lang,t=this.element;t.firstElementChild;)t.removeChild(t.firstElementChild);var n=document.createElement("iframe");n.src=this.URL.replace(/%lang/,e),n.setAttribute("scrolling","no"),n.setAttribute("frameborder","0"),n.setAttribute("allowTransparency","true"),t.appendChild(n)},PSMView.prototype.handleEvent=function(e){switch(e.type){case"localized":this.loadFrame()}};var CanvasView=function(e){this.load(e,{name:"canvas",element:"wc-canvas",canvasElement:"wc-canvas-canvas",hoverElement:"wc-canvas-hover",hoverLabelElement:"wc-canvas-hover-label"}),window.addEventListener("resize",this),this.canvasElement.addEventListener("wordcloudstop",this),this.documentWidth=window.innerWidth,this.documentHeight=window.innerHeight;var n,o,t=this.canvasElement.style;["transform","webkitTransform","msTransform","oTransform"].some(function(e){return e in t&&(this.cssTransformProperty=e,!0)}.bind(this)),this.idleOption={fontFamily:"Times, serif",color:"rgba(255, 255, 255, 0.8)",rotateRatio:.5,backgroundColor:"transparent",wait:75,list:(n=[],o="Arai,Awan,Bodjal,Boira,Bulud,Bulut,Caad,Chmura,Clood,Cloud,Cwmwl,Dampog,Debesis,Ewr,Felhő,Hodei,Hûn,Koumoul,Leru,Lipata,Mixtli,Moln,Mây,Méga,Mākoņi,Neul,Niula,Nivulu,Nor,Nouage,Nuage,Nube,Nubes,Nubia,Nubo,Nuvem,Nuvi,Nuvia,Nuvola,Nwaj,Nívol,Nóvvla,Nùvoła,Nùvula,Núvol,Nûl,Nûlêye,Oblaci,Oblak,Phuyu,Pil'v,Pilv,Pilvi,Qinaya,Rahona,Rakun,Retë,Scamall,Sky,Ský,Swarken,Ulap,Vo'e,Wingu,Wolcen,Wolk,Wolke,Wollek,Wulke,dilnu,Νέφος,Абр,Болот,Болытлар,Булут,Бұлттар,Воблакі,Облак,Облака,Хмара,Үүл,Ամպ,וואלקן,ענן,ابر,بادل,بدل,سحاب,ورېځ,ھەور,ܥܢܢܐ,ढग,बादल,सुपाँय्,মেঘ,ਬੱਦਲ,વાદળ,முகில்,మేఘం,മേഘം,เมฆ,སྤྲིན།,ღრუბელი,ᎤᎶᎩᎸ,ᓄᕗᔭᖅ,云,雲,구름".split(","),[5,4,3,2,2].forEach(function(t){o.forEach(function(e){n.push([e,t])})}),n)}};CanvasView.prototype=new View,CanvasView.prototype.TILT_DEPTH=10,CanvasView.prototype.beforeShow=CanvasView.prototype.beforeHide=function(e,t){switch(t){case this.app.UI_STATE_SOURCE_DIALOG:if(e==this.app.UI_STATE_ABOUT_DIALOG)break;this.drawIdleCloud();break;case this.app.UI_STATE_LOADING:case this.app.UI_STATE_WORKING:this.empty()}},CanvasView.prototype.handleEvent=function(e){switch(e.type){case"resize":this.documentWidth=window.innerWidth,this.documentHeight=window.innerHeight;break;case"wordclouddrawn":if(e.detail.drawn)break;e.preventDefault();break;case"wordcloudstop":this.canvasElement.removeEventListener("wordclouddrawn",this);break;case"mousemove":var t=this.documentWidth/2,n=this.documentHeight/2,o=-(t-e.pageX)/t*this.TILT_DEPTH,i=(n-e.pageY)/n*this.TILT_DEPTH;this.canvasElement.style[this.cssTransformProperty]="scale(1.2) translateZ(0) rotateX("+i+"deg) rotateY("+o+"deg)"}},CanvasView.prototype.setDimension=function(e,t){var n=this.canvasElement;e=e||this.documentWidth,t=t||this.documentHeight,n.setAttribute("width",e),n.setAttribute("height",t),this.element.style.marginLeft=-e/2+"px",this.element.style.marginTop=-t/2+"px"},CanvasView.prototype.draw=function(e){this.canvasElement.lang="",this.hoverElement.setAttribute("hidden",!0),e.hover=this.handleHover.bind(this),WordCloud(this.canvasElement,e)},CanvasView.prototype.handleHover=function(e,t){var n=this.hoverElement;e?(n.removeAttribute("hidden"),n.style.left=t.x+"px",n.style.top=t.y+"px",n.style.width=t.w+"px",n.style.height=t.h+"px",this.hoverDimension=t,this.hoverLabelElement.setAttribute("data-l10n-args",JSON.stringify({word:e[0],count:e[1]})),__(this.hoverLabelElement)):n.setAttribute("hidden",!0)},CanvasView.prototype.drawIdleCloud=function(){var e=this.canvasElement,t=this.documentWidth,n=this.documentHeight;"ontouchstart"in window||document.addEventListener("mousemove",this),this.canvasElement.style[this.cssTransformProperty]="scale(1.2)",this.setDimension(t,n),this.idleOption.gridSize=Math.round(16*t/1024),this.idleOption.weightFactor=function(e){return Math.pow(e,2.3)*t/1024},e.lang="en",e.addEventListener("wordclouddrawn",this),WordCloud(e,this.idleOption),this.hoverElement.setAttribute("hidden",!0)},CanvasView.prototype.empty=function(){document.removeEventListener("mousemove",this),this.canvasElement.style[this.cssTransformProperty]="",WordCloud(this.canvasElement,{backgroundColor:"transparent"})};var SourceDialogView=function(e){this.load(e,{name:"source-dialog",element:"wc-source-dialog",menuElement:"wc-source-menu",selectionElement:"wc-source-selection",startBtnElement:"wc-source-start-btn",panelContainerElement:"wc-source-panels",aboutBtnElement:"wc-source-about-btn"}),this.currentPanel=null,this.panels={};var n=this.selectionElement,t=this.menuElement.getElementsByTagName("a");Array.prototype.forEach.call(t,function(e){var t=document.createElement("option");t.value=e.getAttribute("data-panel"),t.setAttribute("data-l10n-id",e.getAttribute("data-l10n-id")),t.appendChild(document.createTextNode(e.textContent)),n.appendChild(t)}),this.menuElement.addEventListener("click",this),this.selectionElement.addEventListener("change",this),this.startBtnElement.addEventListener("click",this),this.panelContainerElement.addEventListener("submit",this),this.aboutBtnElement.addEventListener("click",this)};SourceDialogView.prototype=new View,SourceDialogView.prototype.afterShow=function(){this.currentPanel&&this.currentPanel.show()},SourceDialogView.prototype.handleEvent=function(e){var t;if(e.preventDefault(),"submit"!=e.type)switch(e.currentTarget){case this.menuElement:if(!(t=e.target.getAttribute("data-panel"))||!this.panels[t])return;this.showPanel(this.panels[t]);break;case this.selectionElement:if(!(t=e.target.value)||!this.panels[t])return;this.showPanel(this.panels[t]);break;case this.aboutBtnElement:this.app.switchUIState(this.app.UI_STATE_ABOUT_DIALOG);break;case this.startBtnElement:this.currentPanel.submit()}else this.currentPanel.submit()},SourceDialogView.prototype.submit=function(e){return this.app.pushUrlHash(e)},SourceDialogView.prototype.showPanel=function(e){this.currentPanel&&this.currentPanel.hide(),e.show(),this.currentPanel=e,this.app&&this.app.logAction("SourceDialogView::showPanel",e.name)},SourceDialogView.prototype.addPanel=function(e){if((this.panels[e.name]=e).menuItemElement=this.menuElement.querySelector('[data-panel="'+e.name+'"]'),e.selectionIndex=Array.prototype.indexOf.call(this.menuElement.children,e.menuItemElement.parentNode),!e.menuItemElement)throw"menuItemElement not found.";if(e.menuItemElement.parentNode.removeAttribute("hidden"),e.dialog=this,"isSupported"in e&&!e.isSupported)return e.menuItemElement.parentNode.className+=" disabled",void e.menuItemElement.removeAttribute("data-panel");this.currentPanel||this.showPanel(e)};var DashboardView=function(e){this.load(e,{name:"dashboard",element:"wc-dashboard"});for(var t=this.element.querySelectorAll("[data-action]"),n=t.length;n--;)t[n].addEventListener("click",this)};DashboardView.prototype=new View,DashboardView.prototype.beforeShow=DashboardView.prototype.beforeHide=function(e,t){var n,o=this.element.querySelectorAll("[data-canvas-ctl]"),i=o.length;if(t===this.app.UI_STATE_DASHBOARD)for(;i--;)(n=o[i]).className=n.className.replace(/ disabled/g,"");else for(;i--;)(n=o[i]).className+=" disabled"},DashboardView.prototype.handleEvent=function(e){var t=e.currentTarget;if(-1===t.className.indexOf("disabled")){var n=this.app,o=t.getAttribute("data-action");switch(this.app.logAction("DashboardView::action",o),o){case"back":n.reset();break;case"refresh":n.draw();break;case"theme":n.data.theme++,n.data.theme>=n.themes.length&&(n.data.theme=0),n.draw();break;case"shape":n.data.shape++,n.data.shape>=n.shapes.length&&(n.data.shape=0),n.draw();break;case"edit":n.switchUIState(n.UI_STATE_LIST_DIALOG);break;case"size+":n.data.weightFactor+=.1,n.draw();break;case"size-":if(n.data.weightFactor<=.1)break;n.data.weightFactor-=.1,n.draw();break;case"gap+":n.data.gridSize++,n.draw();break;case"gap-":if(n.data.gridSize<=2)break;n.data.gridSize--,n.draw();break;case"save":var i=n.getCanvasElement().toDataURL();if("download"in document.createElement("a"))t.href=i,setTimeout(function(){t.href="#"},0);else{e.preventDefault();function a(){r.removeEventListener("load",a),r.detachEvent&&r.detachEvent("onload",a);for(var e=r.document;e.body.firstElementChild;)e.body.removeChild(e.body.firstElementChild);var t=e.createElement("img");t.id="popup-image",t.src=i,e.getElementsByTagName("title")[0].textContent=_("image-popup-title"),e.body.appendChild(t)}var r=window.open("blank.html","_blank","width=500,height=300,resizable=yes,menubar=yes");r.attachEvent?"complete"===r.document.readyState?a():r.attachEvent("onload",a):r.addEventListener("load",a)}break;case"share":n.showSharer()}}};var SharerDialogView=function(e){if(this.load(e,{name:"sharer-dialog",element:"wc-sharer-dialog",titleElement:"wc-sharer-title",imgElement:"wc-sharer-img",imgLinkElement:"wc-sharer-img-link",progressElement:"wc-sharer-progress",titleInputElement:"wc-sharer-title-input",descInputElement:"wc-sharer-desc",termsElement:"wc-sharer-terms",hashTagElement:"wc-sharer-hashtag",imgurStatusElement:"wc-sharer-imgur-status",facebookStatusElement:"wc-sharer-facebook-status",tumblrStatusElement:"wc-sharer-tumblr-status",twitterStatusElement:"wc-sharer-twitter-status",plurkStatusElement:"wc-sharer-plurk-status",reUploadBtnElement:"wc-sharer-reupload-btn",doneBtnElement:"wc-sharer-done-btn"}),this.hashTagElement.textContent=this.HASHTAG,this.imgLinkElement.addEventListener("click",this),this.imgurStatusElement.addEventListener("click",this),this.facebookStatusElement.addEventListener("click",this),this.tumblrStatusElement.addEventListener("click",this),this.twitterStatusElement.addEventListener("click",this),this.plurkStatusElement.addEventListener("click",this),this.doneBtnElement.addEventListener("click",this),this.reUploadBtnElement.addEventListener("click",this),window.URL&&this.imgElement.addEventListener("load",function(){window.URL.revokeObjectURL(this.src)}),!window.HTMLCanvasElement.prototype.toBlob){var t=document.createElement("script");t.src="./assets/canvas-to-blob/canvas-to-blob.min.js?_=k3j9i8ln",document.documentElement.firstElementChild.appendChild(t)}this.stringIds=["image-upload-not-supported","share-text-only","image-uploading","waiting","image-uploaded","click-to-share","image-upload-failed","facebook-loading","load-facebook-sdk","facebook-sdk-loading"]};SharerDialogView.prototype=new View,SharerDialogView.prototype.HASHTAG="#HTML5WordCloud",SharerDialogView.prototype.TWITTER_SHARE_URL="https://twitter.com/home/?status=",SharerDialogView.prototype.PLURK_SHARE_URL="https://plurk.com/?status=",SharerDialogView.prototype.FACEBOOK_PHOTO_URL="https://www.facebook.com/photo.php?fbid=",SharerDialogView.prototype.FACEBOOK_POST_URL="https://www.facebook.com/permalink.php?id=%uid&v=wall&story_fbid=%fbid",SharerDialogView.prototype.IMGUR_URL="https://imgur.com/",SharerDialogView.prototype.IMGUR_API_URL="https://api.imgur.com/3/upload.json",SharerDialogView.prototype.SHARED_ITEM_LIMIT=10,SharerDialogView.prototype.LABEL_IMAGE_UPLOAD_NOT_SUPPORTED=0,SharerDialogView.prototype.LABEL_SHARE_TEXT_ONLY=1,SharerDialogView.prototype.LABEL_IMAGE_UPLOADING=2,SharerDialogView.prototype.LABEL_WAITING=3,SharerDialogView.prototype.LABEL_IMAGE_UPLOADED=4,SharerDialogView.prototype.LABEL_CLICK_TO_SHARE=5,SharerDialogView.prototype.LABEL_IMAGE_UPLOAD_FAILED=6,SharerDialogView.prototype.LABEL_FACEBOOK_LOADING=7,SharerDialogView.prototype.LABEL_LOAD_FBSDK=8,SharerDialogView.prototype.LABEL_FBSDK_LOADING=9,SharerDialogView.prototype.beforeShow=function(){window.FB&&!this.facebookSDKReadyState&&(this.facebookSDKReadyState="complete",FB.getLoginStatus(this.updateFacebookStatus.bind(this)),FB.Event.subscribe("auth.authResponseChange",this.updateFacebookStatus.bind(this))),this.uploadSupported=!!(window.HTMLCanvasElement.prototype.toBlob&&window.XMLHttpRequest&&window.FormData),this.uploadSupported&&!this.imgurData?this.uploadImage():this.updateUI()},SharerDialogView.prototype.updateTermsUI=function(){this.termsElement.textContent=this.getCloudList()},SharerDialogView.prototype.getCloudTitle=function(){return this.app.data.title||_("my-word-cloud")},SharerDialogView.prototype.getCloudList=function(){for(var e=this.app.data.list,t=0,n=[];n[t]=e[t][0],++t<this.SHARED_ITEM_LIMIT;);return n.join(_("sep").replace(/"/g,""))+(e.length>this.SHARED_ITEM_LIMIT?_("frequent-terms-more"):"")},SharerDialogView.prototype.updateFacebookStatusElement=function(e,t){var n=this.facebookStatusElement;switch(this.facebookSDKReadyState){case"complete":this.updateStatusElement(n,e,t);break;case"loading":this.updateStatusElement(n,this.LABEL_FBSDK_LOADING);break;default:this.updateStatusElement(n,this.LABEL_LOAD_FBSDK,"#")}},SharerDialogView.prototype.updateStatusElement=function(e,t,n){n?(e.className="",e.href=n):(e.className="disabled",e.href=""),e.setAttribute("data-l10n-id",this.stringIds[t]),__(e)},SharerDialogView.prototype.updateUI=function(){if(this.xhr)this.reUploadBtnElement.disabled=!0,this.updateStatusElement(this.imgurStatusElement,this.LABEL_IMAGE_UPLOADING),this.updateFacebookStatusElement(this.LABEL_WAITING),this.updateStatusElement(this.tumblrStatusElement,this.LABEL_WAITING),this.updateStatusElement(this.twitterStatusElement,this.LABEL_WAITING),this.updateStatusElement(this.plurkStatusElement,this.LABEL_WAITING);else if(this.imgurData){var e=this.IMGUR_URL+this.imgurData.id;this.reUploadBtnElement.disabled=!1,this.updateStatusElement(this.imgurStatusElement,this.LABEL_IMAGE_UPLOADED,e),this.facebookPostedUrl?this.updateStatusElement(this.facebookStatusElement,this.LABEL_IMAGE_UPLOADED,this.facebookPostedUrl):this.facebookLoading?this.updateStatusElement(this.facebookStatusElement,this.LABEL_FACEBOOK_LOADING):this.updateFacebookStatusElement(this.LABEL_CLICK_TO_SHARE,"#"),this.updateStatusElement(this.tumblrStatusElement,this.LABEL_CLICK_TO_SHARE,"#"),this.updateStatusElement(this.twitterStatusElement,this.LABEL_CLICK_TO_SHARE,"#"),this.updateStatusElement(this.plurkStatusElement,this.LABEL_CLICK_TO_SHARE,"#")}else this.uploadSupported||this.updateTermsUI(),this.reUploadBtnElement.disabled=!0,this.uploadSupported?this.updateStatusElement(this.imgurStatusElement,this.LABEL_IMAGE_UPLOAD_FAILED):this.updateStatusElement(this.imgurStatusElement,this.LABEL_IMAGE_UPLOAD_NOT_SUPPORTED),this.updateFacebookStatusElement(this.LABEL_SHARE_TEXT_ONLY,"#"),this.updateStatusElement(this.tumblrStatusElement,this.LABEL_SHARE_TEXT_ONLY,"#"),this.updateStatusElement(this.twitterStatusElement,this.LABEL_SHARE_TEXT_ONLY,"#"),this.updateStatusElement(this.plurkStatusElement,this.LABEL_SHARE_TEXT_ONLY,"#")},SharerDialogView.prototype.afterHide=function(){this.xhr&&(this.xhr.abort(),this.xhr=null)},SharerDialogView.prototype.handleEvent=function(e){if(e.target.disabled||"disabled"===e.target.className)e.preventDefault();else switch(e.currentTarget){case this.imgLinkElement:if(this.imgurData)break;e.preventDefault();break;case this.facebookStatusElement:if(this.facebookPostedUrl)break;if(!this.facebookSDKReadyState)return this.facebookSDKReadyState="loading",this.updateUI(),(new FacebookSDKLoader).load(function(){"complete"!==this.facebookSDKReadyState&&(this.facebookSDKReadyState="complete",FB.getLoginStatus(this.updateFacebookStatus.bind(this)),FB.Event.subscribe("auth.authResponseChange",this.updateFacebookStatus.bind(this)))}.bind(this)),void e.preventDefault();this.share("facebook"),e.preventDefault();break;case this.tumblrStatusElement:this.share("tumblr"),e.preventDefault();break;case this.twitterStatusElement:this.share("twitter"),e.preventDefault();break;case this.plurkStatusElement:this.share("plurk"),e.preventDefault();break;case this.reUploadBtnElement:this.uploadImage();break;case this.doneBtnElement:this.close()}},SharerDialogView.prototype.close=function(){this.app.switchUIState(this.app.UI_STATE_DASHBOARD)},SharerDialogView.prototype.getCanvasBlob=function(e){this.app.getCanvasElement().toBlob(e.bind(this))},SharerDialogView.prototype.updateProgress=function(e,t){this.progressElement.style.width=Math.floor(100*e)+"%",this.progressElement.parentNode.className="progress progress-striped"+(t?" active":"")},SharerDialogView.prototype.share=function(e){("facebook"!==e||window.UPLOAD_PHOTO_TO_FACEBOOK)&&this.imgurData?this.shareImage(e):this.shareText(e)},SharerDialogView.prototype.shareText=function(e){this.app.logAction("SharerDialogView::shareText",e);var t=this.titleInputElement.value||this.getCloudTitle(),n=this.descInputElement.value||this.getCloudList()+"\n\n"+this.HASHTAG,o=window.location.href,i=128<o.length?o.replace(/#.*$/,""):o;switch(e){case"facebook":var a,r=document.querySelector('meta[property="og:image"]').content;this.facebookLoading=!0,this.updateUI(),a=this.imgurData?{method:"feed",link:this.IMGUR_URL+this.imgurData.id,display:"popup"}:{method:"feed",picture:r,link:o,name:this.getCloudTitle(),description:this.getCloudList()+" -- "+this.HASHTAG,display:"popup"},FB.ui(a,function(e){if(this.facebookLoading=!1,e&&e.post_id){var t=e.post_id.split("_");this.facebookPostedUrl=this.FACEBOOK_POST_URL.replace(/%uid/,t[0]).replace(/%fbid/,t[1]),this.updateUI()}else this.updateUI()}.bind(this));break;case"plurk":window.open(this.PLURK_SHARE_URL+encodeURIComponent(i+" ("+t+") "+n));break;case"twitter":window.open(this.TWITTER_SHARE_URL+encodeURIComponent(i+" "+t+" "+n),null,"width=575,height=216");break;case"tumblr":window.open("https://www.tumblr.com/share/link?description="+encodeURIComponent(n)+"&name="+encodeURIComponent(t)+"&url="+encodeURIComponent(o)),this.close();break;default:throw"Unknown shareDialogView type "+e}},SharerDialogView.prototype.updateFacebookStatus=function(e){"connected"===e.status?FB.api("/me/permissions",function(e){this.hasFacebookPermission=e&&e.data&&e.data[0]&&1==e.data[0].publish_stream,this.updateUI()}.bind(this)):this.hasFacebookPermission=!1,this.updateUI()},SharerDialogView.prototype.uploadImage=function(){if(!window.IMGUR_CLIENT_ID)throw"IMGUR_CLIENT_ID is not set.";this.app.logAction("SharerDialogView::uploadImage"),this.imgurData=void 0,this.facebookPostedUrl=void 0,this.imgLinkElement.href="#",this.updateProgress(.05,!0);var e=this.titleInputElement.value||this.getCloudTitle(),t=this.descInputElement.value||this.getCloudList()+"\n\n"+this.HASHTAG,n=window.location.href;128<n.length&&(n=n.replace(/#.*$/,"")),this.cloudUrl=n;var o=new FormData;o.append("title",e),o.append("name","wordcloud.png"),o.append("description",t+"\n\n"+n);var i=this.xhr=new XMLHttpRequest;i.open("POST",this.IMGUR_API_URL),i.setRequestHeader("Authorization","Client-ID "+IMGUR_CLIENT_ID),i.upload?i.upload.onprogress=function(e){this.updateProgress(e.loaded/e.total,!0)}.bind(this):this.updateProgress(1,!0),i.onreadystatechange=function(){if(i.readyState===XMLHttpRequest.DONE&&this.xhr===i){var e;this.checkImgurCredits(),this.xhr=null;try{e=JSON.parse(i.responseText)}catch(e){}if(!(!!e&&e.success))return e&&429===e.status&&alert(_("imgur-limit-msg")),this.app.logAction("SharerDialogView::uploadImage::failed",e?e.status:"N/A"),this.updateProgress(.05,!1),void this.updateUI();this.imgurData=e.data,this.imgLinkElement.href=this.IMGUR_URL+this.imgurData.id,this.app.logAction("SharerDialogView::uploadImage::success"),this.updateProgress(1,!1),this.updateUI()}}.bind(this),this.updateUI(),this.updateTermsUI(),this.getCanvasBlob(function(e){this.xhr===i&&(window.URL?this.imgElement.src=window.URL.createObjectURL(e):this.imgElement.src=this.app.getCanvasElement().toDataURL(),this.imgLinkElement.removeAttribute("hidden"),o.append("image",e),i.send(o))})},SharerDialogView.prototype.shareImage=function(t){this.app.logAction("SharerDialogView::shareImage2",t);var e=this.titleInputElement.value||this.getCloudTitle(),n=this.descInputElement.value||this.getCloudList()+"\n\n"+this.HASHTAG,o=this.cloudUrl;switch(t){case"facebook":if(!this.hasFacebookPermission)return void FB.login(function(e){this.element.hasAttribute("hidden")?this.app.logAction("SharerDialogView::facebook-login::cancelled"):(this.app.logAction("SharerDialogView::facebook-login::success"),"connected"===e.status&&(this.hasFacebookPermission=!0,this.shareImage(t)))}.bind(this),{scope:"publish_stream"});this.facebookLoading=!0,this.updateUI(),FB.api("/me/photos","post",{url:this.imgurData.link,message:this.titleInputElement.value+"\n\n"+this.descInputElement.value+"\n\n"+o},function(e){if(this.facebookLoading=!1,!e||!e.id)return this.shareText(t),void this.updateUI();this.facebookPostedUrl=this.FACEBOOK_PHOTO_URL+e.id,this.updateUI()}.bind(this));break;case"plurk":window.open(this.PLURK_SHARE_URL+encodeURIComponent(this.imgurData.link+" "+o+" ("+e+") "+n));break;case"twitter":window.open(this.TWITTER_SHARE_URL+encodeURIComponent(o+" "+e+" "+n+" "+this.imgurData.link));break;case"tumblr":window.open("https://www.tumblr.com/share/photo?source="+encodeURIComponent(this.imgurData.link)+"&desc="+encodeURIComponent(e+"\n"+n+"\n\n"+o)+"&clickthru="+encodeURIComponent(o));break;default:throw"Unknown shareDialogView type "+t}},SharerDialogView.prototype.checkImgurCredits=function(){var t=new XMLHttpRequest;t.open("GET","https://api.imgur.com/3/credits"),t.setRequestHeader("Authorization","Client-ID "+IMGUR_CLIENT_ID),t.onreadystatechange=function(){if(t.readyState===XMLHttpRequest.DONE){var e;try{e=JSON.parse(t.responseText)}catch(e){}e&&e.success&&(this.imgurCreditsData=e.data,this.app.logAction("SharerDialogView::checkImgurCredits::ClientRemaining",e.data.ClientRemaining))}}.bind(this),t.send()};var PanelView=function(){};PanelView.prototype=new View,PanelView.prototype.beforeShow=function(){this.menuItemElement.parentNode.className+=" active",this.dialog.selectionElement.selectedIndex=this.selectionIndex},PanelView.prototype.afterShow=function(){var e=this.element.querySelector("input, button, select, textarea");e&&e.focus()},PanelView.prototype.beforeHide=function(){this.menuItemElement.parentNode.className=this.menuItemElement.parentNode.className.replace(/ active/g,"")};var ExamplePanelView=function(e){this.load(e,{name:"example",element:"wc-panel-example",supportMsgElement:"wc-panel-example-support-msg"}),this.checked=!1};ExamplePanelView.prototype=new PanelView,ExamplePanelView.prototype.beforeShow=function(){PanelView.prototype.beforeShow.apply(this,arguments),this.checked||(this.dialog.app.isFullySupported||this.supportMsgElement.removeAttribute("hidden"),this.element.querySelectorAll('[name="example"]')[0].checked=!0,this.checked=!0)},ExamplePanelView.prototype.submit=function(){var e=this.element.querySelectorAll('[name="example"]');for(var t in e)if(e[t].checked){this.dialog.submit("#"+e[t].value);break}};var CPPanelView=function(e){this.load(e,{name:"cp",element:"wc-panel-cp",textareaElement:"wc-panel-cp-textarea"})};CPPanelView.prototype=new PanelView,CPPanelView.prototype.submit=function(){var e=this.textareaElement;e.value.length&&((window.btoa?this.dialog.submit("#base64:"+window.btoa(unescape(encodeURIComponent(e.value)))):this.dialog.submit("#text:"+encodeURIComponent(e.value)))||this.dialog.submit("#text"))};var FilePanelView=function(e){if(this.load(e,{name:"file",element:"wc-panel-file",fileElement:"wc-panel-file-file",fileLabelElement:"wc-panel-file-file-label",encodingElement:"wc-panel-file-encoding"}),this.isSupported){var t=this.fileElement.files.length;this.updateLabel(t),this.fileElement.addEventListener("change",this)}};FilePanelView.prototype=new PanelView,FilePanelView.prototype.handleEvent=function(){var e=this.fileElement.files.length;this.updateLabel(e)},FilePanelView.prototype.updateLabel=function(e){this.fileLabelElement.setAttribute("data-l10n-args",'{ "n": '+e+"}"),__(this.fileLabelElement)},FilePanelView.prototype.isSupported=!!window.FileReader,FilePanelView.prototype.submit=function(){var e=this.fileElement;e.files.length&&("text/plain"===e.files[0].type?this.dialog.submit("#file"):alert(_("plain-text-file-please")))};var WikipediaPanelView=function(e){this.load(e,{name:"wikipedia",element:"wc-panel-wikipedia",inputElement:"wc-panel-wikipedia-title"})};WikipediaPanelView.prototype=new PanelView,WikipediaPanelView.prototype.submit=function(){var e=this.inputElement;if(e.value){var t=document.webL10n.getLanguage().substr(0,2);this.dialog.submit("#wikipedia."+t+":"+e.value)}};var Fetcher=function(){};Fetcher.prototype.LABEL_VERB=LoadingView.prototype.LABEL_LOADING;var TextFetcher=function(){this.types=["text","base64"]};TextFetcher.prototype=new Fetcher,TextFetcher.prototype.stop=function(){clearTimeout(this.timer)},TextFetcher.prototype.getData=function(e,t){t="text"!==e||t?"base64"===e?decodeURIComponent(escape(window.atob(t))):decodeURIComponent(t):this.app.views["source-dialog"].panels.cp.textareaElement.value,this.timer=setTimeout(function(){this.app.handleData(t)}.bind(this),0)};var FileFetcher=function(){this.types=["file"]};FileFetcher.prototype=new Fetcher,FileFetcher.prototype.stop=function(){this.reader&&(this.reader.abort(),this.reader=null)},FileFetcher.prototype.getData=function(){var e=this.app.views["source-dialog"].panels.file,t=e.fileElement;if(!t.files.length)return this.app.reset(),void this.app.views["source-dialog"].showPanel(e);var n=t.files[0],o=this.reader=new FileReader;o.onloadend=function(){if(o===this.reader&&null!==o.result){var e=o.result;this.app.handleData(e)}}.bind(this),o.readAsText(n,e.encodingElement.value||"UTF-8")};var ListFetcher=function(){this.types=["list","base64-list"]};ListFetcher.prototype=new Fetcher,ListFetcher.prototype.stop=function(){clearTimeout(this.timer)},ListFetcher.prototype.getData=function(e,t){var n;n="list"!==e||t?"base64-list"===e?decodeURIComponent(escape(window.atob(t))):decodeURIComponent(t):this.app.views["list-dialog"].textElement.value;var o=0,i=[];n.split("\n").forEach(function(e){var t=e.split("\t").reverse();e&&t[0]&&t[1]&&(t[1]=parseInt(t[1],10),isNaN(t[1])||(o+=t[0].length*t[1]*t[1],i.push(t)))}),this.timer=setTimeout(function(){this.app.handleList(i,o)}.bind(this),0)};var JSONPScriptDownloader=function(){};JSONPScriptDownloader.prototype.CALLBACK_PREFIX="JSONPCallbackX",JSONPScriptDownloader.prototype.reset=JSONPScriptDownloader.prototype.stop=function(){this.currentRequest=void 0,clearTimeout(this.timer)},JSONPScriptDownloader.prototype.handleEvent=function(e){var t=e.target;window[t.getAttribute("data-callback-name")]=void 0,this.currentRequest=void 0,clearTimeout(this.timer),t.parentNode.removeChild(t),"error"===e.type&&this.fetcher.handleResponse()},JSONPScriptDownloader.prototype.getNewCallbackName=function(){var e=this.CALLBACK_PREFIX+Math.random().toString(36).substr(2,8).toUpperCase();return window[e]=function(){this.currentRequest===e&&(this.currentRequest=void 0,clearTimeout(this.timer),this.fetcher.handleResponse.apply(this.fetcher,arguments))}.bind(this),e},JSONPScriptDownloader.prototype.requestData=function(e){var t=this.currentRequest=this.getNewCallbackName();e+=-1===e.indexOf("?")?"?":"&",e+="callback="+t;var n=this.scriptElement=document.createElement("script");n.src=e,n.setAttribute("data-callback-name",t),n.addEventListener("load",this),n.addEventListener("error",this),document.documentElement.firstElementChild.appendChild(n),clearTimeout(this.timer),this.timer=setTimeout(function(){window[t]()},this.fetcher.TIMEOUT)};var JSONPWorkerDownloader=function(){};JSONPWorkerDownloader.prototype.PATH="./assets/",JSONPWorkerDownloader.prototype.reset=JSONPWorkerDownloader.prototype.stop=function(){this.worker&&(clearTimeout(this.timer),this.worker.terminate(),this.worker=null)},JSONPWorkerDownloader.prototype.requestData=function(e){this.worker&&this.stop(),this.worker=new Worker(this.PATH+"downloader-worker.js"),this.worker.addEventListener("message",this),this.worker.addEventListener("error",this),this.worker.postMessage(e),clearTimeout(this.timer),this.timer=setTimeout(function(){this.stop(),this.fetcher.handleResponse()}.bind(this),this.fetcher.TIMEOUT)},JSONPWorkerDownloader.prototype.handleEvent=function(e){var t;switch(e.type){case"message":t=e.data;break;case"error":t=[],e.preventDefault()}this.stop(),this.fetcher.handleResponse.apply(this.fetcher,t)};var JSONPFetcher=function(){};JSONPFetcher.prototype=new Fetcher,JSONPFetcher.prototype.LABEL_VERB=LoadingView.prototype.LABEL_DOWNLOADING,JSONPFetcher.prototype.USE_WORKER_WHEN_AVAILABLE=!0,JSONPFetcher.prototype.TIMEOUT=3e4,JSONPFetcher.prototype.reset=function(){this.downloader&&this.downloader.reset()},JSONPFetcher.prototype.stop=function(){this.downloader&&this.downloader.stop(),this.downloader=null},JSONPFetcher.prototype.requestData=function(e){this.USE_WORKER_WHEN_AVAILABLE&&window.Worker?this.downloader=new JSONPWorkerDownloader:this.downloader=new JSONPScriptDownloader,(this.downloader.fetcher=this).downloader.requestData(e)};var WikipediaFetcher=function(){this.types=["wiki","wikipedia"],this.params=[["action","query"],["prop","revisions"],["rvprop","content"],["redirects","1"],["format","json"],["rvparse","1"]]};WikipediaFetcher.prototype=new JSONPFetcher,WikipediaFetcher.prototype.WIKIPEDIA_API_URL="https://%lang.wikipedia.org/w/api.php",WikipediaFetcher.prototype.DEFAULT_LANG="en",WikipediaFetcher.prototype.PARSED_WIKITEXT_REGEXP=/<[^>]+?>|\(.+?\.\.\.\)|\&\w+\;|<script.+?\/script\>/gi,WikipediaFetcher.prototype.getData=function(e,t){var n=[].concat(this.params),o=e.split("."),i=o[1]?o[1]:this.DEFAULT_LANG;o[2]&&n.push(["converttitles",o[2]]),n.push(["titles",t]);var a=this.WIKIPEDIA_API_URL.replace(/%lang/,i)+"?"+n.map(function(e){return e[0]+"="+encodeURIComponent(e[1])}).join("&");this.requestData(a)},WikipediaFetcher.prototype.handleResponse=function(e){if(e){var t=Object.keys(e.query.pages)[0],n=e.query.pages[t];if("revisions"in n){var o=n.revisions[0]["*"].replace(this.PARSED_WIKITEXT_REGEXP,"");this.app.handleData(o,_("wikipedia-title",{title:n.title}))}else this.app.handleData("")}else this.app.handleData("")},"timdream.org"===window.location.hostname&&(window.location.href="https://wordcloud.timdream.org/"+window.location.hash);var _gaq=_gaq||[];"1"!==navigator.doNotTrack?(_gaq.push(["_setAccount","UA-4623408-2"]),_gaq.push(["_trackPageview"]),function(){var e=document.createElement("script");e.type="text/javascript",e.async=!0,e.src=("https:"==document.location.protocol?"https://ssl":"http://www")+".google-analytics.com/ga.js";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()):window.console&&(_gaq.push=function(){Function.prototype.apply.call(console.log,console,arguments),Array.prototype.push.apply(this,arguments)}),window.onerror=function(e,t,n){_gaq.push(["_trackEvent","JavaScript Exceptions",e,t+" ("+n+")"])},function(){if(document.querySelectorAll&&window.console){var e=document.querySelector('meta[property="og:image"]').content,t=document.querySelector('meta[property="og:url"]').content,n=document.querySelector('meta[property="fb:app_id"]').content,o=window.location.href.replace(/#.*$/,"").replace(/\?.*$/,"");(e.substr(0,o.length)!==o||t.substr(0,o.length)!==o||window.FACEBOOK_APP_ID&&n!==window.FACEBOOK_APP_ID)&&console.warn("Remember to change the content of <meta> tags in HTML.")}}(),function(){void 0===window.__&&(window.__=document.webL10n.translate),WordFreq.isSupported?WordFreqSync=null:WordFreq=null;var e=new WordCloudApp;if(e.isSupported){(new LanguageSwitcherView).app=e,(new SNSPushView).show(),(new PSMView).show(),e.addView(new CanvasView),e.addView(new LoadingView),e.addView(new DashboardView),e.addView(new ListDialogView),e.addView(new SharerDialogView),e.addView(new AboutDialogView);var t=new SourceDialogView;e.addView(t),t.addPanel(new ExamplePanelView),t.addPanel(new CPPanelView),t.addPanel(new FilePanelView),t.addPanel(new WikipediaPanelView),e.addFetcher(new TextFetcher),e.addFetcher(new FileFetcher),e.addFetcher(new ListFetcher),e.addFetcher(new WikipediaFetcher)}}();